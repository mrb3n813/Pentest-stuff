 <?php
/*
* 	   Simple PHP upload form.
* 	   Usage: create a directory in /var/www/html named 'files' i.e mkdir /var/www/html/files
*          chown www-data:www-data -R /var/www/html/files 
*          chmod 777 -R /var/www/html/files ((chmod 777 is BAD but makes things easier, just remove the perms later)
*          You can easily add more file extensions to the array.
*/        
	if(isset($_FILES['file'])){
		$errors= array();
		$file_name = $_FILES['file']['name'];
		$file_size =$_FILES['file']['size'];
		$file_tmp =$_FILES['file']['tmp_name'];
		$file_type=$_FILES['file']['type'];   
		$file_ext=strtolower(end(explode('.',$_FILES['file']['name'])));
		
		$extensions= array("zip","nessus","tar"); 		
		if(in_array($file_ext,$extensions)=== false){
			$errors[]="Don't mess with me bro!";
		}
						
		if(empty($errors)==true){
			move_uploaded_file($file_tmp,"files/".$file_name);
			echo "Success";
		}else{
			print_r($errors);
		}
	}
?>

<form action="" method="POST" enctype="multipart/form-data">
<input type="file" name="file" />
<input type="submit"/>
</form>
